## 内存管理

- CADisplayLink、NSTimer使用注意
  - 会对target产生强引用，可以通过block弱引用或者NSProxy+消息转发（相比于NSObject，省去了方法查找过程）
  - NSTimer依赖于Runloop无法保证时效性，GCD(dispatch_source)依赖于内核更准时 

- 介绍内存的几大区域

  - 低->高： 保留区域、代码段、数据段(字符串常量、已初始化变量、未初始化变量)、堆（低到高）、栈（高到低）、内核区

- Tagged Pointer  

  - 用于NSNumber、NSDate、NSString

  - 判断是否是Tagged Pointer ：iOS下 & 1<<63 = 1<<63，mac下 & 1 = 1

- ARC做了什么

  - 通过LLVM操作引用计算器+Runtime处理弱引用操作等

- MRC

  - alloc、retain、release、autorelease、copy

- weak的实现

  - 对象销毁后会自动将指针置为nil

- AutoreleasePool

  - AutoreleasePoolPush 

  - autoreleasePoolPop

  - autoreleasePoolPage类

    - 成员变量

      - ```
        magic_t magic; 
        id *next; 
        pthread_t thread; 
        AutoreleasePoolPage *parent; 
        AutoreleasePoolPage *child; 
        uint32_t depth; 
        uint32_t hiwat;
        ```

    - 占用4096字节，除了存放成员变量，剩下空间用来存在autorelease对象地址

    - autoreleasePoolPage之间通过双向链表形式连接在一起

- iOS内存管理的理解

