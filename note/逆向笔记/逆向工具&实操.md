SSH、OpenSSH Secure shell 安全外壳协议，为远程登录提供安全保证协议。Git

SSL、OpenSSL Secure Sockets Layer网络传输安全协议

OpenSSH保证安全是依赖于OpenSSL

SSH通信过程三大阶段：建立安全连接、客户端认证和数据传输

- 保留端口

  - 21 ftp
  - 80 http
  - 22 ssh

- sh脚本文件

  - sh、bash 启动子进程执行脚本，执行后回到父线程的shell环境

  - source、. 在当前的shell环境下执行脚本

    

opensource.apple.com/tarballs

xnu-苹果的内核

在.bash_profile写环境配置，快捷输入



## 工具

- Cycript 手机的终端，用于运行调试
- Reveal 查看视图层级
- class-dump 获取Mach-O头文件
- Hopper Disassmbler 将机器代码反编译成汇编或伪代码 
- ida64工具  同上
- machoview 可视化查看可执行文件信息
- 砸壳工具 Clutch/dumpdecrypted
- theos 实现Hook操作 

  - logos语法
  - logify.pl 快速将头文件转换成包含打印信息(%log，%org)的XM文件
- Synalyze It
- UE查看二进制
- libimobiledevice
- 动态调试

  - xcode：gdb->lldb

  - 终端启动lldb连接手机debugserver，debugserver监听app
- ldid添加手机端应用权限



删除广告流程：（104集）

1. 使用Clutch/dumpdescrypted砸壳
2. 通过Reveal/Cyc ript找到视图类名
3. Hopper 找到该类的方法和申明
4. theos-tweak改写该类的函数，例如将初始化返回Nil等  

   





## 指令

file指令可查看文件类型

lipo -info 看架构

otool 查看可执行文件内容  可用Machoview替代 









## 主题内容

- mac通过usbmuxd映射端口，模拟wifi访问手机端口

- SSL与SSH

- Mach-O的组成

  - https://www.desgard.com/iosre-1/

- dyld源码、dyld shared cache 动态库共享缓存 /usr/lib/dyld程序->LoadContext

  xnu-苹果的内核源码

- exit(0)与abort() 源码分析

- 加壳&砸壳 

  动态脱壳需要先将程序运行，对于iOS来说更加麻烦，所以普遍采用软脱壳

  通过MachOView或者`otool -l app | grep Crypt`查看Load Commands中 LC_ENCRYPTION_INFO 的 Crypt ID 检验是否加密

- 工具介绍

  - theos-tweak 使用&执行流程&原理

- 逆向实战演练 eg:去广告？

- MakeFile

- 命令行工具的编写

  -  给可执行文件签上读写权限entitlements（ldid工具）
  - eg:  MJAppTools
  
  

- ASLR

  - 函数的内存地址（VM Address） = File Offset + ASLR Offset + __PAGEZERO Size
  - 运行时app的开始地址就是 ASLR 偏移地址，image list -o -f | grep app
  - 设置空指针是指向 _PAGEZERO

  


- Mach-O
  - size -l -m -x 查看Mach-O的内存分布
  - Header
  - Load Commands
  - Data